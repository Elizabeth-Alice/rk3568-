<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RK3568 æ™ºèƒ½ç‰©è”ç½‘æ§åˆ¶ä¸­å¿ƒ</title>
    <!-- å¼•å…¥ç°ä»£åŒ– UI æ¡†æ¶ï¼šTailwind CSS + DaisyUI -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
    <!-- å›¾æ ‡åº“ï¼šHeroicons -->
    <script src="https://unpkg.com/heroicons@2.0.18/dist/heroicons.min.js"></script>
    <!-- è§†é¢‘æµæ”¯æŒï¼šHLS.jsï¼ˆç”¨äº mjpeg-streamer å…¼å®¹ï¼‰ -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        :root {
            --primary-color: #1e40af;
            --secondary-color: #1e3a8a;
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #3b82f6 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .sensor-card {
            transition: all 0.3s ease;
        }
        .sensor-card:hover {
            transform: translateY(-4px);
        }
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 */
            height: 0;
            overflow: hidden;
            background: #000;
            border-radius: 1rem;
        }
        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 1rem;
        }
        .status-dot {
            height: 12px;
            width: 12px;
            background-color: #22c55e;
            border-radius: 50%;
            display: inline-block;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">

    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="navbar bg-base-100 shadow-lg sticky top-0 z-50 card-shadow">
        <div class="flex-1">
            <a href="#" class="btn btn-ghost text-xl font-bold text-primary">
                <svg class="w-8 h-8 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                </svg>
                RK3568 æ™ºèƒ½æ§åˆ¶ä¸­å¿ƒ
            </a>
        </div>
        <div class="flex-none gap-2">
            <div class="indicator">
                <span class="indicator-item badge badge-success"></span>
                <button id="system-status" class="btn btn-ghost btn-circle">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0114 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                </button>
            </div>
            <div class="dropdown dropdown-end">
                <label tabindex="0" class="btn btn-ghost btn-circle avatar">
                    <div class="w-10 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2">
                        <img src="https://ui-avatars.com/api/?name=RK&background=1e40af&color=fff" alt="User" />
                    </div>
                </label>
                <ul tabindex="0" class="mt-3 p-2 shadow menu menu-sm dropdown-content bg-base-100 rounded-box w-52">
                    <li><a>ç³»ç»Ÿä¿¡æ¯</a></li>
                    <li><a>æ—¥å¿—æŸ¥çœ‹</a></li>
                    <li><a class="text-error">é€€å‡ºç™»å½•</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container mx-auto p-4 md:p-6 max-w-7xl">

        <!-- è®¾å¤‡çŠ¶æ€æ¦‚è§ˆå¡ç‰‡ -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
            <div class="card bg-base-100 card-shadow sensor-card">
                <div class="card-body p-5">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm font-medium text-gray-500">CPU ä½¿ç”¨ç‡</h3>
                            <p class="text-2xl font-bold text-primary" id="cpu-usage">0%</p>
                        </div>
                        <svg class="w-10 h-10 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="card bg-base-100 card-shadow sensor-card">
                <div class="card-body p-5">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm font-medium text-gray-500">å†…å­˜ä½¿ç”¨</h3>
                            <p class="text-2xl font-bold text-warning" id="mem-usage">0 MB</p>
                        </div>
                        <svg class="w-10 h-10 text-warning" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m-8-4v4"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="card bg-base-100 card-shadow sensor-card">
                <div class="card-body p-5">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm font-medium text-gray-500">æ¸©åº¦</h3>
                            <p class="text-2xl font-bold text-success" id="temperature">-- Â°C</p>
                        </div>
                        <svg class="w-10 h-10 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m8.485-9.485l-.707.707M5.222 5.222l.707.707m12.364 0l-.707-.707M6.343 17.657l-.707-.707m12.728 0l-.777.777m-14.656 0l-.777-.777"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="card bg-base-100 card-shadow sensor-card">
                <div class="card-body p-5">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm font-medium text-gray-500">åœ¨çº¿çŠ¶æ€</h3>
                            <p class="text-lg font-bold flex items-center gap-2">
                                <span class="status-dot"></span>
                                <span class="text-success">å·²è¿æ¥</span>
                            </p>
                        </div>
                        <svg class="w-10 h-10 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- è§†é¢‘æµ + æ§åˆ¶åŒº -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">

            <!-- è§†é¢‘æµåŒºåŸŸ -->
            <div class="lg:col-span-2">
                <div class="card bg-base-100 card-shadow">
                    <div class="card-body p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="card-title text-2xl">å®æ—¶è§†é¢‘æµ</h2>
                            <div class="flex gap-2">
                                <button id="snapshot-btn" class="btn btn-success btn-sm">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    </svg>
                                    æ‹ç…§
                                </button>
                                <button id="record-btn" class="btn btn-error btn-sm">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                    <span id="record-text">å¼€å§‹å½•åƒ</span>
                                </button>
                            </div>
                        </div>
                        <div class="video-container">
                            <video id="video-stream" controls autoplay muted class="rounded-lg"></video>
                            <div id="stream-placeholder" class="flex flex-col items-center justify-center h-full text-gray-400">
                                <svg class="w-16 h-16 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <p>æ­£åœ¨è¿æ¥è§†é¢‘æµ...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è®¾å¤‡æ§åˆ¶é¢æ¿ -->
            <div>
                <div class="card bg-base-100 card-shadow h-full">
                    <div class="card-body p-6">
                        <h2 class="card-title text-xl mb-4">è®¾å¤‡æ§åˆ¶</h2>

                        <!-- LED æ§åˆ¶ -->
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <label class="font-medium">LED ç¯</label>
                                <input type="checkbox" id="led-toggle" class="toggle toggle-primary" />
                            </div>
                            <div class="mt-3">
                                <label class="text-sm text-gray-600">äº®åº¦è°ƒèŠ‚</label>
                                <input type="range" min="0" max="100" value="70" id="led-brightness" class="range range-xs range-primary" />
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>0%</span>
                                    <span id="led-value">70%</span>
                                    <span>100%</span>
                                </div>
                            </div>
                        </div>

                        <!-- é£æ‰‡æ§åˆ¶ -->
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <label class="font-medium">é£æ‰‡</label>
                                <input type="checkbox" id="fan-toggle" class="toggle toggle-success" />
                            </div>
                            <div class="mt-3">
                                <label class="text-sm text-gray-600">é£é€Ÿæ§åˆ¶</label>
                                <input type="range" min="0" max="100" value="50" id="fan-speed" class="range range-xs range-success" />
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>åœæ­¢</span>
                                    <span id="fan-value">50%</span>
                                    <span>é«˜é€Ÿ</span>
                                </div>
                            </div>
                            <div class="flex gap-2 mt-3">
                                <button id="fan-forward" class="btn btn-sm btn-outline flex-1">æ­£è½¬</button>
                                <button id="fan-reverse" class="btn btn-sm btn-outline flex-1">åè½¬</button>
                            </div>
                        </div>

                        <!-- èœ‚é¸£å™¨ -->
                        <div>
                            <label class="font-medium">èœ‚é¸£å™¨</label>
                            <button id="buzzer-btn" class="btn btn-warning btn-sm w-full mt-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586m4.707-2.293a1 1 0 00-1.414-1.414l-1.5 1.5m0 0a1 1 0 001.414 1.414l1.5-1.5m-1.5 1.5l-1.5 1.5a1 1 0 001.414 1.414l1.5-1.5m0 0l1.5 1.5a1 1 0 001.414-1.414l-1.5-1.5"></path>
                                </svg>
                                è§¦å‘è­¦æŠ¥
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¼ æ„Ÿå™¨æ•°æ®å±•ç¤º -->
        <div class="card bg-base-100 card-shadow mb-6">
            <div class="card-body p-6">
                <h2 class="card-title text-xl mb-4">ä¼ æ„Ÿå™¨å®æ—¶æ•°æ®</h2>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                    <!-- ä¼ æ„Ÿå™¨é¡¹æ¨¡æ¿ -->
                    <div class="text-center p-4 bg-base-200 rounded-xl">
                        <div class="text-3xl mb-1" id="sensor1-icon">ğŸŒ¡ï¸</div>
                        <p class="text-sm text-gray-600">æ¸©åº¦</p>
                        <p class="text-xl font-bold" id="sensor1">--</p>
                    </div>
                    <div class="text-center p-4 bg-base-200 rounded-xl">
                        <div class="text-3xl mb-1">ğŸ’§</div>
                        <p class="text-sm text-gray-600">æ¹¿åº¦</p>
                        <p class="text-xl font-bold" id="sensor2">--</p>
                    </div>
                    <div class="text-center p-4 bg-base-200 rounded-xl">
                        <div class="text-3xl mb-1">ğŸ’¨</div>
                        <p class="text-sm text-gray-600">PM2.5</p>
                        <p class="text-xl font-bold" id="sensor3">--</p>
                    </div>
                    <div class="text-center p-4 bg-base-200 rounded-xl">
                        <div class="text-3xl mb-1">ğŸ”¥</div>
                        <p class="text-sm text-gray-600">ç«ç„°</p>
                        <p class="text-xl font-bold text-error" id="sensor4">æ­£å¸¸</p>
                    </div>
                    <div class="text-center p-4 bg-base-200 rounded-xl">
                        <div class="text-3xl mb-1">ğŸš¶</div>
                        <p class="text-sm text-gray-600">äººä½“</p>
                        <p class="text-xl font-bold text-success" id="sensor5">æœªæ£€æµ‹</p>
                    </div>
                    <div class="text-center p-4 bg-base-200 rounded-xl">
                        <div class="text-3xl mb-1">âš¡</div>
                        <p class="text-sm text-gray-600">å…‰ç…§</p>
                        <p class="text-xl font-bold" id="sensor6">-- lx</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ—¥å¿—ä¸æ“ä½œè®°å½• -->
        <div class="card bg-base-100 card-shadow">
            <div class="card-body p-6">
                <h2 class="card-title text-xl mb-4">æ“ä½œæ—¥å¿—</h2>
                <div class="h-48 overflow-y-auto bg-base-200 rounded-lg p-4 font-mono text-sm" id="log-area">
                    <p class="text-gray-500">ç³»ç»Ÿå¯åŠ¨å®Œæˆï¼Œç­‰å¾…è¿æ¥...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- è„šæœ¬ï¼šè¿æ¥åç«¯ CGI ä¸æ•°æ®æ›´æ–° -->
    <script>
        // å…¨å±€å˜é‡
        const video = document.getElementById('video-stream');
        const placeholder = document.getElementById('stream-placeholder');
        const recordBtn = document.getElementById('record-btn');
        const recordText = document.getElementById('record-text');
        let isRecording = false;
        let streamSource = null;

        // æ›´æ–°è®¾å¤‡çŠ¶æ€æ•°æ®
        function updateDeviceStatus() {
            fetch('/api/device_state')
                .then(response => response.json())
                .then(data => {
                    // æ›´æ–°æ¸©åº¦æ˜¾ç¤º
                    document.getElementById('temperature').textContent = data.temperature.toFixed(1) + ' Â°C';
                    document.getElementById('sensor1').textContent = data.temperature.toFixed(1);
                    
                    // æ›´æ–°æ¹¿åº¦æ˜¾ç¤º
                    document.getElementById('sensor2').textContent = data.humidity.toFixed(1);
                    
                    // æ›´æ–°LEDçŠ¶æ€
                    const ledToggle = document.getElementById('led-toggle');
                    const ledValue = document.getElementById('led-value');
                    ledToggle.checked = data.led_state === 1;
                    ledValue.textContent = data.led_brightness + '%';
                    document.getElementById('led-brightness').value = data.led_brightness;
                    
                    // æ›´æ–°é£æ‰‡çŠ¶æ€
                    const fanToggle = document.getElementById('fan-toggle');
                    const fanValue = document.getElementById('fan-value');
                    fanToggle.checked = data.fan_state === 1;
                    fanValue.textContent = data.fan_speed + '%';
                    document.getElementById('fan-speed').value = data.fan_speed;
                    
                    // æ›´æ–°é£æ‰‡æ–¹å‘æŒ‰é’®çŠ¶æ€
                    const fanForward = document.getElementById('fan-forward');
                    const fanReverse = document.getElementById('fan-reverse');
                    if (data.fan_dir === 0) {
                        fanForward.classList.add('btn-primary');
                        fanReverse.classList.remove('btn-primary');
                    } else {
                        fanForward.classList.remove('btn-primary');
                        fanReverse.classList.add('btn-primary');
                    }
                    
                    // æ·»åŠ æ—¥å¿—
                    addLog(`ğŸ“Š æ•°æ®æ›´æ–°: æ¸©åº¦${data.temperature.toFixed(1)}Â°C æ¹¿åº¦${data.humidity.toFixed(1)}% LED${data.led_state} é£æ‰‡${data.fan_state}`);
                })
                .catch(error => {
                    console.error('è·å–è®¾å¤‡çŠ¶æ€å¤±è´¥:', error);
                    addLog('âŒ è·å–è®¾å¤‡çŠ¶æ€å¤±è´¥');
                });
        }

        // æ·»åŠ æ—¥å¿—å‡½æ•°
        function addLog(message) {
            const logArea = document.getElementById('log-area');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('p');
            logEntry.innerHTML = `<span class="text-gray-400">[${timestamp}]</span> ${message}`;
            logArea.appendChild(logEntry);
            logArea.scrollTop = logArea.scrollHeight;
        }

        // 1. åˆå§‹åŒ–è§†é¢‘æµ (mjpeg-streamer ç¤ºä¾‹)
        function initVideoStream() {
            const streamUrl = 'http://' + window.location.hostname + ':8080/?action=stream'; // æ ¹æ®å®é™…ä¿®æ”¹
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(streamUrl.replace('stream', 'stream.m3u8'));
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    video.play();
                    placeholder.style.display = 'none';
                });
            } else if (video.canPlayType('application/x-mpegURL')) {
                video.src = streamUrl;
                video.addEventListener('loadedmetadata', () => {
                    video.play();
                    placeholder.style.display = 'none';
                });
            } else {
                // fallback to MJPEG
                video.src = streamUrl;
                video.addEventListener('load', () => {
                    placeholder.style.display = 'none';
                });
            }
        }

        // 2. æ‹ç…§
        document.getElementById('snapshot-btn').addEventListener('click', () => {
            fetch('/cgi-bin/snapshot.cgi', { method: 'POST' })
                .then(r => r.text())
                .then(data => {
                    addLog(`ğŸ“¸ æ‹ç…§æˆåŠŸ: ${data}`);
                    alert('ç…§ç‰‡å·²ä¿å­˜ï¼');
                })
                .catch(() => addLog('âŒ æ‹ç…§å¤±è´¥'));
        });

        // 3. å½•åƒæ§åˆ¶
        recordBtn.addEventListener('click', () => {
            const action = isRecording ? 'stop' : 'start';
            fetch(`/cgi-bin/record.cgi?action=${action}`, { method: 'POST' })
                .then(r => r.text())
                .then(data => {
                    isRecording = !isRecording;
                    recordBtn.classList.toggle('btn-error');
                    recordBtn.classList.toggle('btn-success');
                    recordText.textContent = isRecording ? 'åœæ­¢å½•åƒ' : 'å¼€å§‹å½•åƒ';
                    addLog(isRecording ? 'ğŸ¥ å¼€å§‹å½•åƒ' : 'â¹ï¸ åœæ­¢å½•åƒ');
                })
                .catch(() => addLog('âŒ å½•åƒæ§åˆ¶å¤±è´¥'));
        });

        // 4. LEDæ§åˆ¶
        document.getElementById('led-toggle').addEventListener('change', (e) => {
            const state = e.target.checked ? 1 : 0;
            addLog(`ğŸ’¡ LED ${state ? 'å¼€å¯' : 'å…³é—­'}`);
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ§åˆ¶LEDçš„APIè°ƒç”¨
        });

        document.getElementById('led-brightness').addEventListener('input', (e) => {
            document.getElementById('led-value').textContent = e.target.value + '%';
            addLog(`ğŸ’¡ LEDäº®åº¦è°ƒæ•´ä¸º ${e.target.value}%`);
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ§åˆ¶LEDäº®åº¦çš„APIè°ƒç”¨
        });

        // 5. é£æ‰‡æ§åˆ¶
        document.getElementById('fan-toggle').addEventListener('change', (e) => {
            const state = e.target.checked ? 1 : 0;
            addLog(`ğŸ’¨ é£æ‰‡ ${state ? 'å¼€å¯' : 'å…³é—­'}`);
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ§åˆ¶é£æ‰‡çš„APIè°ƒç”¨
        });

        document.getElementById('fan-speed').addEventListener('input', (e) => {
            document.getElementById('fan-value').textContent = e.target.value + '%';
            addLog(`ğŸ’¨ é£æ‰‡é€Ÿåº¦è°ƒæ•´ä¸º ${e.target.value}%`);
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ§åˆ¶é£æ‰‡é€Ÿåº¦çš„APIè°ƒç”¨
        });

        document.getElementById('fan-forward').addEventListener('click', () => {
            addLog('ğŸ’¨ é£æ‰‡è®¾ç½®ä¸ºæ­£è½¬');
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ§åˆ¶é£æ‰‡æ–¹å‘çš„APIè°ƒç”¨
        });

        document.getElementById('fan-reverse').addEventListener('click', () => {
            addLog('ğŸ’¨ é£æ‰‡è®¾ç½®ä¸ºåè½¬');
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ§åˆ¶é£æ‰‡æ–¹å‘çš„APIè°ƒç”¨
        });

        // 6. èœ‚é¸£å™¨æ§åˆ¶
        document.getElementById('buzzer-btn').addEventListener('click', () => {
            addLog('ğŸ”Š è§¦å‘èœ‚é¸£å™¨è­¦æŠ¥');
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ§åˆ¶èœ‚é¸£å™¨çš„APIè°ƒç”¨
        });

        // 7. å®šæ—¶æ›´æ–°è®¾å¤‡çŠ¶æ€ï¼ˆæ¯ç§’æ›´æ–°ï¼‰
        setInterval(updateDeviceStatus, 1000);

        // 8. é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            addLog('ğŸŒ é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹è¿æ¥è®¾å¤‡...');
            updateDeviceStatus(); // ç«‹å³æ›´æ–°ä¸€æ¬¡çŠ¶æ€
            // initVideoStream(); // å¦‚æœéœ€è¦è§†é¢‘æµå¯ä»¥å–æ¶ˆæ³¨é‡Š
        });
    </script>
</body>
</html>